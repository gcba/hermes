!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Ratings=t()}(this,function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function s(e){var t=new FileReader,r=a(t);return t.readAsArrayBuffer(e),r}function l(e){var t=new FileReader,r=a(t);return t.readAsText(e),r}function u(e){for(var t=new Uint8Array(e),r=new Array(t.length),i=0;i<t.length;i++)r[i]=String.fromCharCode(t[i]);return r.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&g(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(e){var t=e.toUpperCase();return x.indexOf(t)>-1?t:e}function b(e,t){var r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new n(t.headers)),this.method=f(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),i=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(n))}}),t}function d(e){var t=new n;return e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),i=r.shift().trim();if(i){var n=r.join(":").trim();t.append(i,n)}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new n(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var m={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(m.arrayBuffer)var S=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&S.indexOf(Object.prototype.toString.call(e))>-1};n.prototype.append=function(e,i){e=t(e),i=r(i);var n=this.map[e];this.map[e]=n?n+","+i:i},n.prototype.delete=function(e){delete this.map[t(e)]},n.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(e,i){this.map[t(e)]=r(i)},n.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},n.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),i(e)},n.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},n.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),i(e)},m.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},p.call(b.prototype),p.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];y.redirect=function(e,t){if(-1===O.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=n,e.Request=b,e.Response=y,e.fetch=function(e,t){return new Promise(function(r,i){var n=new b(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:d(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new y(t,e))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&m.blob&&(o.responseType="blob"),n.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===n._bodyInit?null:n._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:void 0);var r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=e(function(e){!function(t){var r=/iPhone/i,i=/iPod/i,n=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,a=/Android/i,s=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,l=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,u=/Windows Phone/i,c=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,f=/BB10/i,b=/Opera Mini/i,h=/(CriOS|Chrome)(?=.*\bMobile\b)/i,d=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,y=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),m=function(e,t){return e.test(t)},S=function(e){var t=e||navigator.userAgent,S=t.split("[FBAN");if(void 0!==S[1]&&(t=S[0]),void 0!==(S=t.split("Twitter"))[1]&&(t=S[0]),this.apple={phone:m(r,t),ipod:m(i,t),tablet:!m(r,t)&&m(n,t),device:m(r,t)||m(i,t)||m(n,t)},this.amazon={phone:m(s,t),tablet:!m(s,t)&&m(l,t),device:m(s,t)||m(l,t)},this.android={phone:m(s,t)||m(o,t),tablet:!m(s,t)&&!m(o,t)&&(m(l,t)||m(a,t)),device:m(s,t)||m(l,t)||m(o,t)||m(a,t)},this.windows={phone:m(u,t),tablet:m(c,t),device:m(u,t)||m(c,t)},this.other={blackberry:m(p,t),blackberry10:m(f,t),opera:m(b,t),firefox:m(d,t),chrome:m(h,t),device:m(p,t)||m(f,t)||m(b,t)||m(d,t)||m(h,t)},this.seven_inch=m(y,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},g=function(){var e=new S;return e.Class=S,e};e.exports&&"undefined"==typeof window?e.exports=S:e.exports&&"undefined"!=typeof window?e.exports=g():t.isMobile=g()}(r)}),n=e(function(e,t){(function(){function i(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function n(e,t,r){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),e=a(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function o(e,t){var r=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=w)for(;++r<i;)t(e[r],r,e);else s(e,t)}function a(e){return e=f(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:i(e)}function s(e,t){for(var r in e)_.call(e,r)&&t(e[r],r,e)}function l(e){return null==e?i(e):I.call(e).slice(8,-1)}function u(e,t){var r=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(r)||"object"==r&&!e[t])}function c(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function p(e,t){var r=null;return o(e,function(i,n){r=t(r,i,n,e)}),r}function f(e){return String(e).replace(/^ +| +$/g,"")}function b(e){function t(t){return p(t,function(t,r){var i=r.pattern||c(r);return!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(r.label&&!RegExp(i,"i").test(r.label)?r.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),r=r.label||r,t=a(t[0].replace(RegExp(i,"i"),r).replace(RegExp("; *(?:"+r+"[_-])?","i")," ").replace(RegExp("("+r+")[-_.]?(\\w)","i"),"$1 $2"))),t})}var r=d,i=e&&"object"==typeof e&&"String"!=l(e);i&&(r=e,e=null);var o=r.navigator||{},h=o.userAgent||"";e||(e=h);var m,S,g=i||O==y,w=i?!!o.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(I.toString()),v=i?"Object":"ScriptBridgingProxyObject",_=i?"Object":"Environment",A=i&&r.java?"JavaPackage":l(r.java),E=i?"Object":"RuntimeObject",T=/\bJava/.test(A)&&r.java,P=T&&l(r.environment)==_,M=T?"a":"α",B=T?"b":"β",k=r.document||{},N=r.operamini||r.opera,R=x.test(R=i&&N?N["[[Class]]"]:l(N))?R:N=null,F=e,C=[],W=null,j=e==h,D=j&&N&&"function"==typeof N.version&&N.version(),L=function(t){return p(t,function(t,r){return t||RegExp("\\b"+(r.pattern||c(r))+"\\b","i").exec(e)&&(r.label||r)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),G=function(t){return p(t,function(t,r){return t||RegExp("\\b"+(r.pattern||c(r))+"\\b","i").exec(e)&&(r.label||r)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=t([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),U=function(t){return p(t,function(t,r,i){return t||(r[V]||r[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+c(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),K=function(t){return p(t,function(t,r){var i=r.pattern||c(r);return!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=n(t,i,r.label||r)),t})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(L&&(L=[L]),U&&!V&&(V=t([U])),(m=/\bGoogle TV\b/.exec(V))&&(V=m[0]),/\bSimulator\b/i.test(e)&&(V=(V?V+" ":"")+"Simulator"),"Opera Mini"==G&&/\bOPiOS\b/.test(e)&&C.push("running in Turbo/Uncompressed mode"),"IE"==G&&/\blike iPhone OS\b/.test(e)?(U=(m=b(e.replace(/like iPhone OS/,""))).manufacturer,V=m.product):/^iP/.test(V)?(G||(G="Safari"),K="iOS"+((m=/ OS ([\d_]+)/i.exec(e))?" "+m[1].replace(/_/g,"."):"")):"Konqueror"!=G||/buntu/i.test(K)?U&&"Google"!=U&&(/Chrome/.test(G)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(V))||/\bAndroid\b/.test(K)&&/^Chrome/.test(G)&&/\bVersion\//i.test(e)?(G="Android Browser",K=/\bAndroid\b/.test(K)?K:"Android"):"Silk"==G?(/\bMobi/i.test(e)||(K="Android",C.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&C.unshift("accelerated")):"PaleMoon"==G&&(m=/\bFirefox\/([\d.]+)\b/.exec(e))?C.push("identifying as Firefox "+m[1]):"Firefox"==G&&(m=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(K||(K="Firefox OS"),V||(V=m[1])):!G||(m=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(G))?(G&&!V&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(m+"/")+8))&&(G=null),(m=V||U||K)&&(V||U||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(K))&&(G=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(K)?K:m)+" Browser")):"Electron"==G&&(m=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&C.push("Chromium "+m):K="Kubuntu",D||(D=function(t){return p(t,function(t,r){return t||(RegExp(r+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",c(G),"(?:Firefox|Minefield|NetFront)"])),(m="iCab"==L&&parseFloat(D)>3&&"WebKit"||/\bOpera\b/.test(G)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(e)&&("Mac OS"==K?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(G)&&"NetFront")&&(L=[m]),"IE"==G&&(m=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(G+=" Mobile",K="Windows Phone "+(/\+$/.test(m)?m:m+".x"),C.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(G="IE Mobile",K="Windows Phone 8.x",C.unshift("desktop mode"),D||(D=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=G&&"Trident"==L&&(m=/\brv:([\d.]+)/.exec(e))&&(G&&C.push("identifying as "+G+(D?" "+D:"")),G="IE",D=m[1]),j){if(u(r,"global"))if(T&&(F=(m=T.lang.System).getProperty("os.arch"),K=K||m.getProperty("os.name")+" "+m.getProperty("os.version")),g&&u(r,"system")&&(m=[r.system])[0]){K||(K=m[0].os||null);try{m[1]=r.require("ringo/engine").version,D=m[1].join("."),G="RingoJS"}catch(e){m[0].global.system==r.system&&(G="Narwhal")}}else"object"==typeof r.process&&!r.process.browser&&(m=r.process)?"object"==typeof m.versions?"string"==typeof m.versions.electron?(C.push("Node "+m.versions.node),G="Electron",D=m.versions.electron):"string"==typeof m.versions.nw&&(C.push("Chromium "+D,"Node "+m.versions.node),G="NW.js",D=m.versions.nw):(G="Node.js",F=m.arch,K=m.platform,D=(D=/[\d.]+/.exec(m.version))?D[0]:"unknown"):P&&(G="Rhino");else l(m=r.runtime)==v?(G="Adobe AIR",K=m.flash.system.Capabilities.os):l(m=r.phantom)==E?(G="PhantomJS",D=(m=m.version||null)&&m.major+"."+m.minor+"."+m.patch):"number"==typeof k.documentMode&&(m=/\bTrident\/(\d+)/i.exec(e))?(D=[D,k.documentMode],(m=+m[1]+4)!=D[1]&&(C.push("IE "+D[1]+" mode"),L&&(L[1]=""),D[1]=m),D="IE"==G?String(D[1].toFixed(1)):D[0]):"number"==typeof k.documentMode&&/^(?:Chrome|Firefox)\b/.test(G)&&(C.push("masking as "+G+" "+D),G="IE",D="11.0",L=["Trident"],K="Windows");K=K&&a(K)}if(D&&(m=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(D)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(j&&o.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(W=/b/i.test(m)?"beta":"alpha",D=D.replace(RegExp(m+"\\+?$"),"")+("beta"==W?B:M)+(/\d+\+?/.exec(m)||"")),"Fennec"==G||"Firefox"==G&&/\b(?:Android|Firefox OS)\b/.test(K))G="Firefox Mobile";else if("Maxthon"==G&&D)D=D.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))"Xbox 360"==V&&(K=null),"Xbox 360"==V&&/\bIEMobile\b/.test(e)&&C.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(G)&&(!G||V||/Browser|Mobi/.test(G))||"Windows CE"!=K&&!/Mobi/i.test(e))if("IE"==G&&j)try{null===r.external&&C.unshift("platform preview")}catch(e){C.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(e))&&(m=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||D)?(K=((m=[m,/BB10/.test(e)])[1]?(V=null,U="BlackBerry"):"Device Software")+" "+m[0],D=null):this!=s&&"Wii"!=V&&(j&&N||/Opera/.test(G)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==G&&/\bOS X (?:\d+\.){2,}/.test(K)||"IE"==G&&(K&&!/^Win/.test(K)&&D>5.5||/\bWindows XP\b/.test(K)&&D>8||8==D&&!/\bTrident\b/.test(e)))&&!x.test(m=b.call(s,e.replace(x,"")+";"))&&m.name&&(m="ing as "+m.name+((m=m.version)?" "+m:""),x.test(G)?(/\bIE\b/.test(m)&&"Mac OS"==K&&(K=null),m="identify"+m):(m="mask"+m,G=R?a(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(m)&&(K=null),j||(D=null)),L=["Presto"],C.push(m));else G+=" Mobile";(m=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(m=[parseFloat(m.replace(/\.(\d)$/,".0$1")),m],"Safari"==G&&"+"==m[1].slice(-1)?(G="WebKit Nightly",W="alpha",D=m[1].slice(0,-1)):D!=m[1]&&D!=(m[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(D=null),m[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==m[0]&&537.36==m[2]&&parseFloat(m[1])>=28&&"WebKit"==L&&(L=["Blink"]),j&&(w||m[1])?(L&&(L[1]="like Chrome"),m=m[1]||((m=m[0])<530?1:m<532?2:m<532.05?3:m<533?4:m<534.03?5:m<534.07?6:m<534.1?7:m<534.13?8:m<534.16?9:m<534.24?10:m<534.3?11:m<535.01?12:m<535.02?"13+":m<535.07?15:m<535.11?16:m<535.19?17:m<536.05?18:m<536.1?19:m<537.01?20:m<537.11?"21+":m<537.13?23:m<537.18?24:m<537.24?25:m<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),m=(m=m[0])<400?1:m<500?2:m<526?3:m<533?4:m<534?"4+":m<535?5:m<537?6:m<538?7:m<601?8:"8"),L&&(L[1]+=" "+(m+="number"==typeof m?".x":/[.+]/.test(m)?"":"+")),"Safari"==G&&(!D||parseInt(D)>45)&&(D=m)),"Opera"==G&&(m=/\bzbov|zvav$/.exec(K))?(G+=" ",C.unshift("desktop mode"),"zvav"==m?(G+="Mini",D=null):G+="Mobile",K=K.replace(RegExp(" *"+m+"$"),"")):"Safari"==G&&/\bChrome\b/.exec(L&&L[1])&&(C.unshift("desktop mode"),G="Chrome Mobile",D=null,/\bOS X\b/.test(K)?(U="Apple",K="iOS 4.3+"):K=null),D&&0==D.indexOf(m=/[\d.]+$/.exec(K))&&e.indexOf("/"+m+"-")>-1&&(K=f(K.replace(m,""))),L&&!/\b(?:Avant|Nook)\b/.test(G)&&(/Browser|Lunascape|Maxthon/.test(G)||"Safari"!=G&&/^iOS/.test(K)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(G)&&L[1])&&(m=L[L.length-1])&&C.push(m),C.length&&(C=["("+C.join("; ")+")"]),U&&V&&V.indexOf(U)<0&&C.push("on "+U),V&&C.push((/^on /.test(C[C.length-1])?"":"on ")+V),K&&(m=/ ([\d.+]+)$/.exec(K),S=m&&"/"==K.charAt(K.length-m[0].length-1),K={architecture:32,family:m&&!S?K.replace(m[0],""):K,version:m?m[1]:null,toString:function(){var e=this.version;return this.family+(e&&!S?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(m=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(F))&&!/\bi686\b/i.test(F)?(K&&(K.architecture=64,K.family=K.family.replace(RegExp(" *"+m),"")),G&&(/\bWOW64\b/i.test(e)||j&&/\w(?:86|32)$/.test(o.cpuClass||o.platform)&&!/\bWin64; x64\b/i.test(e))&&C.unshift("32-bit")):K&&/^OS X/.test(K.family)&&"Chrome"==G&&parseFloat(D)>=39&&(K.architecture=64),e||(e=null);var $={};return $.description=e,$.layout=L&&L[0],$.manufacturer=U,$.name=G,$.prerelease=W,$.product=V,$.ua=e,$.version=G&&D,$.os=K||{architecture:null,family:null,version:null,toString:function(){return"null"}},$.parse=b,$.toString=function(){return this.description||""},$.version&&C.unshift(D),$.name&&C.unshift(G),K&&G&&(K!=String(K).split(" ")[0]||K!=G.split(" ")[0]&&!V)&&C.push(V?"("+K+")":"on "+K),C.length&&($.description=C.join(" ")),$}var h={function:!0,object:!0},d=h[typeof window]&&window||this,y=d,m=h.object&&t,S=h.object&&e&&!e.nodeType&&e,g=m&&S&&"object"==typeof r&&r;!g||g.global!==g&&g.window!==g&&g.self!==g||(d=g);var w=Math.pow(2,53)-1,x=/\bOpera/,O=this,v=Object.prototype,_=v.hasOwnProperty,I=v.toString,A=b();m&&S?s(A,function(e,t){m[t]=e}):d.platform=A}).call(r)}),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=[],l=function(e){s.push(e)},u={isString:function(e){return"string"==typeof e||e instanceof String},isBool:function(e){return"boolean"==typeof e},isInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},isPlainObject:function(e){return"object"===(void 0===e?"undefined":a(e))&&null!==e&&e.constructor===Object&&!1===e.hasOwnProperty("isPrototypeOf")&&"[object Object]"===e.toString()}},c={options:function(e){if(u.isPlainObject(e))return!0;l("INVALID_OPTIONS")},rating:function(e){if(u.isInteger(e)&&e>=-127&&e<=127)return e;l("INVALID_RATING")},description:function(e){if(u.isString(e)){var t=e.trim();return t.length<3&&l("DESCRIPTION_TOO_SHORT"),t.length>30&&l("DESCRIPTION_TOO_LONG"),t}l("INVALID_DESCRIPTION")},comment:function(e){if(u.isString(e)){var t=e.trim();return t.length<3&&l("COMMENT_TOO_SHORT"),t.length>1e3&&l("COMMENT_TOO_LONG"),t}l("INVALID_COMMENT")},key:function(e,t){if(e&&u.isString(e.trim())&&32===e.trim().length)return e.trim();l("INVALID_"+t.toUpperCase())},token:function(e){if(e&&u.isString(e)&&e.trim().length>0)return e.trim();l("INVALID_TOKEN")},url:function(e){var t=new RegExp(/^(ftp|http|https):\/\/[^ "]+$/);if(e&&u.isString(e)&&t.test(e.trim())){var r=e.trim();return"/"===r[r.length-1]?r+"ratings":r+"/ratings"}l("INVALID_ENDPOINT")},appVersion:function(e){if(u.isString(e)){var t=e.trim();return t.length<1&&l("VERSION_TOO_SHORT"),t.length>15&&l("VERSION_TOO_LONG"),t}l("INVALID_VERSION")},isMobile:function(e){if(void 0===e||null===e||u.isBool(e))return e;l("INVALID_IS_MOBILE")},userAgent:function(e){if(u.isString(e)&&e.trim().length>0)return e.trim();l("INVALID_USER_AGENT")},name:function(e){if(u.isString(e)){var t=e.trim();return t.length<3&&l("NAME_TOO_SHORT"),t.length>70&&l("NAME_TOO_LONG"),t}l("INVALID_NAME")},email:function(e){var t=new RegExp(/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/);if(u.isString(e)&&t.test(e.trim())){var r=e.trim();return r.length<3&&l("EMAIL_TOO_SHORT"),r.length>100&&l("EMAIL_TOO_LONG"),r}l("INVALID_EMAIL")},mibaId:function(e){if(u.isString(e)&&36===e.length)return e.trim();l("INVALID_MIBAID")}};return function(){function e(r){t(this,e),c.options(r),this._keys={},this._versions={},this._screen={},this._keys.app=c.key(r.app,"app"),this._keys.platform=c.key(r.platform,"platform"),this._keys.range=c.key(r.range,"range"),this._appVersion=c.appVersion(r.version),this._url=c.url(r.api),this._token=c.token(r.token),this._userAgent=r.userAgent?c.userAgent(r.userAgent):window.navigator.userAgent,this._isMobile=c.isMobile(r.isMobile),this._platform=n.parse(this._userAgent)}return o(e,[{key:"create",value:function(e){var t={rating:c.rating(e.rating),range:this._keys.range,app:this.app,platform:this.platform,device:this.device,browser:this.browser};return e.description&&(t.description=c.description(e.description)),e.comment&&(t.comment=c.comment(e.comment)),this.user&&(t.user=this.user),this.send(t)}},{key:"send",value:function(e){var t=this,r={method:"POST",headers:new Headers({"Content-Type":"application/json; charset=UTF-8",Accept:"application/json",Authorization:"Bearer "+this._token}),body:JSON.stringify(e)};return new Promise(function(e,t){0===s.length?e():t(s.slice(0)),s=[]}).then(function(){return fetch(t._url,r)}).then(function(e){return e.json()})}},{key:"isMobile",get:function(){return void 0===this._isMobile||null===this._isMobile?i.any:this._isMobile}},{key:"app",get:function(){return{key:this._keys.app,version:this._appVersion}}},{key:"platform",get:function(){return{key:this._keys.platform,version:this._platform.os.version}}},{key:"device",get:function(){var e={name:this.isMobile?this._platform.product:"Desktop",screen:this.screen};return this.isMobile&&this._platform.manufacturer&&(e.brand=this._platform.manufacturer),e}},{key:"screen",get:function(){return{width:this._screen.width||window.screen.width,height:this._screen.height||window.screen.height}},set:function(e){u.isPlainObject(e)||l("INVALID_SCREEN"),!u.isInteger(e.width)&&e>0&&l("INVALID_SCREEN_WIDTH"),!u.isInteger(e.width)&&e>0&&l("INVALID_SCREEN_HEIGHT"),this._screen=e}},{key:"user",get:function(){if(this._user){var e={};return this._user.name&&(e.name=this._user.name),this._user.email&&(e.email=this._user.email),this._user.mibaId&&(e.mibaId=this._user.mibaId),e}},set:function(e){var t=u.isString(e.name)&&e.name.trim().length>0,r=u.isString(e.email)&&e.email.trim().length>0,i=u.isString(e.mibaId)&&e.mibaId.trim().length>0,n=c.name(e.name),o=c.email(e.email),a={};u.isPlainObject(e)||l("INVALID_USER"),t||l("MISSING_NAME"),r||i||l("MISSING_EMAIL_AND_MIBAID"),t&&(a.name=n),r&&(a.email=o),i&&(a.mibaId=c.mibaId(e.mibaId)),this._user=a}},{key:"browser",get:function(){return{name:this._platform.name,version:this._platform.version}}}]),e}()});
